<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.blackboard.dao.CommentDao">
	<!-- 目的：为dao接口方法提供sql语句配置 -->

	
	<select id="getAllComments" resultType="Comment" parameterType="map">
		SELECT
			*
		FROM
			tb_comment
		WHERE
			enterprise_id = #{enterpriseId}
		AND 
			blackboard_id = #{blackboardId}
		ORDER BY 
			comment_time 
	</select>
	
	<select id="selectCommentById" resultType="Comment" parameterType="String">
		SELECT
			*
		FROM
			tb_comment
		WHERE
			comment_id = #{commentId}
	</select>
	
	
	<select id="selectCount" parameterType="String" resultType="Integer">
		SELECT 
			COUNT(*)
		FROM 
			tb_comment
		WHERE 
			blackboard_id = #{blackboardId}
	</select>
	
	<insert id="addComment" parameterType="Comment">
		INSERT INTO 
			tb_comment
		<trim prefix="(" suffix=")" suffixOverrides=",">
            comment_id,blackboard_id,enterprise_id,commenter_id,comment_content,comment_time,reply_name,commenter_name  
           <if test="replyId != null">
                ,reply_id
            </if> 
        </trim>
        <trim prefix="values(" suffix=")" suffixOverrides=",">
            #{commentId},#{blackboardId},#{enterpriseId},#{commenterId},#{commentContent},now(),#{replyName},#{commenterName}
            <if test="replyId != null">
               ,#{replyId}
            </if> 
        </trim>
	</insert>
	
	<delete id="deleteComments" parameterType="map">
		DELETE FROM
			tb_comment
		WHERE 
			enterprise_id = #{enterpriseId}
		AND
			blackboard_id = #{blackboardId}
	</delete>
    
</mapper>